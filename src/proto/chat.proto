syntax = "proto3";

package chat;

import "google/protobuf/empty.proto";
service ChatService {
  rpc Ping(google.protobuf.Empty) returns (PingResponse);
  rpc GetChatHistory(GetChatHistoryRequest) returns (GetChatHistoryResponse);
  rpc SendMessage(SendMessageRequest) returns (SendMessageResponse);
  rpc GetRoomsData(GetRoomsDataRequest) returns (GetRoomsDataResponse);
}

message GetChatHistoryRequest {
  optional string roomId = 1;
  string roomType = 2;
  string userId = 3;
  repeated string participants = 4;
  int32 limit = 5;
  int32 skip = 6;
}

message ChatMessage {
  string roomId = 1;
  int32 messageId = 2;
  string content = 3;
  string userId = 4;
  string userSlugId = 5;
  string createdAt = 6;
  string updatedAt = 7;
  string status = 8;
}

message GetChatHistoryResponse {
  repeated ChatMessage messages = 1;
}

message SendMessageRequest {
  optional string roomId = 1;
  repeated string participants = 2;
  string content = 3;
  string userId = 4;
  string userSlugId = 5;
}

message SendMessageResponse {
  ChatMessage message = 1;
}

message PingResponse {
  string message = 1;
}

message GetRoomsDataRequest {
  repeated string roomIds = 1;
}

message lastMessage {
  string sender = 1;
  string content = 2;
  string timestamp = 3;
}

message ChatRoom {
  string roomId = 1;
  repeated string participants = 2;
  lastMessage lastMessage = 3;
  string roomType = 4; // e.g., PRIVATE, GROUP
  string updatedAt = 5;
}

message GetRoomsDataResponse {
  repeated ChatRoom rooms = 1;
}